---
redirect_from:
  - "/02/01-numpy"
interact_link: content/02/01_Numpy.ipynb
kernel_name: python3
kernel_path: content/02
has_widgets: false
title: |-
  Intro to Numpy
pagenum: 8
prev_page:
  url: /02/00_Data_Wrangling_Intro.html
next_page:
  url: /02/01a-numpy-practice.html
suffix: .ipynb
search: np code array numpy numbers x python memory random draw seed computer commands into operations class because dont slow file run just not elements creates results issue before repo range type why objects work add same media giphy arrays ever start pandas set much later during github speed execute should programming executing every operation thats c next cant lets square element matrix return rows cols never without analysis vector covering open participation files location needs line those replicated change rerun main here deal ram computers both terms me its fast e g high level language above languages few must example

comment: "***PROGRAMMATICALLY GENERATED, DO NOT EDIT. SEE ORIGINAL FILES IN /content***"
---

    <main class="jupyter-page">
    <div id="page-info"><div id="page-title">Intro to Numpy</div>
</div>
    <div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Numpy">Numpy<a class="anchor-link" href="#Numpy"> </a></h1><p>We start this module of class by covering <code>numpy</code>, because <code>pandas</code> is built on top of <code>numpy</code>.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span> <span class="c1"># by convention, numpy is always imported with the alias np</span>
<span class="kn">import</span> <span class="nn">random</span>
</pre></div>

    </div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p><strong>Open a folder on your computer with your participation files and open Jupyter to that location.</strong></p>
<h2 id="Outline">Outline<a class="anchor-link" href="#Outline"> </a></h2><ol>
<li>Beware of memory needs and don't overload your computer</li>
<li>If your code is slow, find the offending line(s), and try to optimize those</li>
<li>If you draw random numbers, set a seed so that your results can be replicated and so they don't change everytime you rerun the code</li>
<li>Numpy and basic commands</li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Python-and-Scientific-Computing">Python and Scientific Computing<a class="anchor-link" href="#Python-and-Scientific-Computing"> </a></h2>
</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-issue-of-memory">The issue of memory<a class="anchor-link" href="#The-issue-of-memory"> </a></h3><ul>
<li><strong>MY MAIN POINT HERE:</strong> The files we deal with will get larger as the class moves forward. Typically, a file on the computer hard drive takes up <em>twice</em> as much space in memory (RAM). <em><strong>Be mindful of that and don't load a file that will exceed your computer's available RAM!</strong></em> </li>
<li>Large file sizes will require us to develop workarounds, both in terms of how they are loaded and used, and how they are shared. We will deal with these later. If you run into issues with memory constraints before we cover it more formally, elevate the issue to me before/during/after class, your TA and me during office hours, and the GitHub discussion repo. </li>
</ul>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="The-issue-of-speed">The issue of speed<a class="anchor-link" href="#The-issue-of-speed"> </a></h3><p>Python's biggest strength is the manner in which we write its code. We write plain statements like <code>for i in range(10): print(i)</code>. This makes it easy and fast to write and debug code. We don't explicitly write many particulars that the computer needs to know to execute code (e.g. what type is this variable, what operations should I call for that type, how much memory do I allocate for this process?). This is why Python is a "high level" language - it is written at a level far from the computer's language (binary).</p>
<p>The main cost of this is that Python code can be <em>sloooooooooow</em> to execute. But remember that <code>total time = programming time + executing time</code>:</p>
<ul>
<li>Python, as I mentioned above, tends to minimize <code>programming time</code> relative to other languages. </li>
<li>Executing time is, to an approximation, free: Start executing slow code and go see a movie, sleep through the night, or whatever! There is nothing better than having fun and being able to simultaneously claim "you're working".</li>
<li>Usually, your code is slow because of one or only a few lines of code. If the code must be speed up, we can identify the culprit, and apply one of a few fixes.</li>
</ul>
<p>An example that shows why Python is slow is the following:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="c1"># a &quot;+&quot; sign isn&#39;t just a plus sign</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="mi">14</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
<span class="n">a</span><span class="p">,</span><span class="n">b</span><span class="o">=</span><span class="s2">&quot;py &quot;</span><span class="p">,</span><span class="s2">&quot;is good&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">a</span><span class="o">+</span><span class="n">b</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>17
py is good
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Python handled that like a pro! The "+" operator saw numbers and added, but then it saw strings and concatenated.</p>
<p><strong>Q:</strong> How did it do that? <strong>A:</strong> The interpreter in each line checked the objects the "+" was operating on and applied the correct method!</p>
<p>However, checking objects before every operation involves considerable work:</p>
<ul>
<li>If you want to add 10 numbers, that's 9 addition operations, plus each time the code checks both objects involved, which is another 18 operations. So it took 27 steps to add 10 numbers. </li>
<li>Languages like FORTRAN and C are compiled, and users have to declare that all 10 numbers are numbers, so C code just plows ahead and is done in 9 steps. </li>
<li>It is even worse than that, because in C, the next number in an array is always the same distance from the prior number (in terms of its physical location in memory). Meanwhile, in Python, the program can't quite assume the next number is the same distance away. These "look ups" can cause huge delays.</li>
</ul>
<p>So here is an example: Let's pull random numbers and square them:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">y</span> <span class="o">=</span> <span class="mi">0</span>     
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1000000</span><span class="p">):</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">+=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Wall time: 1.08 s
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Oye, that's not good.</p>
<p><img src="https://media.giphy.com/media/26AHLNr8en8J3ovOo/giphy.gif" alt=""></p>
<p>We haven't earned that high five yet, Ghostrider.</p>
<h3 id="The-speed-solution">The speed solution<a class="anchor-link" href="#The-speed-solution"> </a></h3><p><strong>Vectorization.</strong> Send commands on arrays to the computer pre-compiled, with efficient native machine code.</p>
<p>Let's redo the code above:</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="o">%%time</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1000000</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>Wall time: 46.8 ms
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Bam! That is muuuuuch faster. I think we earned that five...</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p>.</p>
<p><img src="https://media.giphy.com/media/26AHCgWcYM1xSqMaA/giphy.gif" alt=""></p>
<p><strong>Back to our regularly scheduled programming:</strong></p>
<h3 id="Why-did-that-work?">Why did that work?<a class="anchor-link" href="#Why-did-that-work?"> </a></h3><ul>
<li>In the slow version, we effectively sent the computer 3m commands: draw a number, square it, then add to prior. </li>
<li>In the fast version, we sent those 3m commands embedded into just 3 array commands: draw an array of numbers, square all the elements of the array, sum the array. The array functions are optimized to use native machine code and don't have to check each element for type. </li>
</ul>
<p><strong>Verdict: arrays and vectorization are great*! And in Python, we implement them using <code>numpy</code>.</strong></p>
<p>So let's learn some <code>numpy</code>!</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Numpy---A-veeeery-quick-guide">Numpy - A veeeery quick guide<a class="anchor-link" href="#Numpy---A-veeeery-quick-guide"> </a></h2><p><em>(HINT: Jupyter's "Help" menu has a link to Numpy documentation.)</em></p>
<p>You can access an element of a numpy array just like a list: <code>x=np.arange(1,5,1); x[1]</code>. If the array is a matrix, <code>x[row,col]</code> works.</p>
<p>As usual, check out <a href="https://jakevdp.github.io/PythonDataScienceHandbook/02.02-the-basics-of-numpy-arrays.html">Whirlwind</a> for a more comprehensive dive into splitting, slicing, and more operations.</p>
<h3 id="Common-methods:">Common methods:<a class="anchor-link" href="#Common-methods:"> </a></h3><p><strong>YOUR TURN:</strong> I suggest copying (by literally typing, not pasting!) these commands into your personal cheat sheet. During class, I'm just going to quickly read these off, so return to this later.</p>
<ul>
<li><code>np.array([user defined list, or lists of lists])</code> creates an array or matrix</li>
<li><code>np.ones(how many)</code> and <code>np.ones([rows,cols])</code>, same but all elements are 1</li>
<li><code>np.zeros(how many)</code> and <code>np.zeros([rows,cols])</code>, same but all elements are 0</li>
<li><code>np.arange(start,end,stepsize)</code> , creates array, note that the array will not include any elements <code>&gt;=end</code></li>
<li><code>np.linspace(from,to,# of elements)</code>, creates array covering the range specified</li>
<li><code>np.eye(#)</code> creates an identity matrix of size #x#</li>
<li><code>np.concatenate([x, y])</code> combines arrays <code>x</code> and <code>y</code> </li>
<li><code>np.nan</code> is a NaN object (e.g. like a missing element in a data table)</li>
<li><code>np.ceil(#)</code>, <code>np.floor(#)</code> if #=3.4, ceil will return 4, and floor will return 3.</li>
<li><code>np.max(x)</code>, <code>np.min(x)</code>, <code>np.average(x)</code>, <code>np.mediam(x)</code> and many more statistical operations work as you would expect</li>
<li><code>np.reshape(x,[rows,cols])</code> works as it looks</li>
<li><code>np.random.&lt;dist&gt;</code> can draw random numbers from many distributions<ul>
<li>use tab autocompletion to see all the options (type <code>np.random.</code> and then hit TAB)</li>
<li><strong>YOU MUST NEVER EVER EVER EVER EVER DRAW RANDOM NUMBERS WITHOUT SETTING A SEED!!!</strong>    </li>
</ul>
</li>
</ul>
<h3 id="ASIDE:-ALWAYS-SET-A-SEED!">ASIDE: ALWAYS SET A SEED!<a class="anchor-link" href="#ASIDE:-ALWAYS-SET-A-SEED!"> </a></h3><p>Why have I emphasized a "seed" so much? Well, suppose you run analysis, and in it, you draw random numbers.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.0776388  0.79816138 0.89095822 0.19309575 0.22132198 0.99545593
 0.97664861 0.29155159 0.89413791 0.03145377]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we run some analysis that uses that vector...</p>
<p>But then later, someone else tries to replicate your results, so they run</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vector</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[0.55146202 0.78933851 0.51876759 0.63832625 0.1738114  0.99936084
 0.91071885 0.3878562  0.84329425 0.23836685]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>UH-OH. <strong>The rest of their analysis will not match yours. Your results can't be replicated.</strong></p>
<p>Possibly more annoying: Every time <strong>YOU</strong> rerun it, the results will change!</p>
<p><strong>HOW TO SET A SEED:</strong></p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-ipython3"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="c1"># the seed is 100</span>
<span class="n">vector</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span>
<span class="n">vector2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">vector</span><span class="o">==</span><span class="n">vector2</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="jb_output_wrapper }}">
<div class="output_area">

<div class="output_subarea output_stream output_stdout output_text">
<pre>[ True  True  True  True  True  True  True  True  True  True]
</pre>
</div>
</div>
</div>
</div>
</div>

</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now, using 100 as the seed, others can replicate your code.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h3 id="Numpy-with-pandas">Numpy with pandas<a class="anchor-link" href="#Numpy-with-pandas"> </a></h3><p>These operations all work on pandas objects. That's the tweet.</p>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="The-dark-side-of-vectors-and-numpy">The dark side of vectors and <code>numpy</code><a class="anchor-link" href="#The-dark-side-of-vectors-and-numpy"> </a></h2><ol>
<li>You can't vectorize every operation :(</li>
<li>Can be prohibitive, memory-wise: When you run an array operation, Python creates the entire array and puts it into memory, then runs it. A vector of length <code>1,000,000,000,000</code> is huge and requires substantial memory to create. By contrast, you can execute <code>for i in range(1,000,000,000,000): pass</code> without causing an issue, because Python <strong>never created that vector, it just iterated over numbers</strong>. This is because <code>range(#)</code> is a "generator" and not an explicit object. </li>
</ol>

</div>
</div>
</div>
</div>

<div class="jb_cell">

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Before-next-class">Before next class<a class="anchor-link" href="#Before-next-class"> </a></h2><ol>
<li><strong>YOUR TURN:</strong> Find "01a-numpy-practice.ipynb" worksheet inside the lecture repo, then answer all the questions and place the file inside your participation repo.</li>
<li>Find the last lecture in the github repo, and copy the "Golden Rules" into your <code>navigating_github.md</code> file. Then, at the bottom of that table, add a new row: the first column should say "Randoms" and the second column should say "NEVER DRAW RANDOM NUMBERS WITHOUT A SEED". </li>
</ol>

</div>
</div>
</div>
</div>

 


    </main>
    